<!doctype html>
<html lang="en"><head>
    <meta charset="utf-8">
    <title>Wraith Documentation</title>
    <!-- Mobile viewport optimized -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <!-- Mobile Internet Explorer allows us to activate ClearType technology for smoothing fonts for easy reading -->
    <meta http-equiv="cleartype" content="on">

    <!-- Le styles -->
    <link href="css/bootswatch/Cosmo/bootstrap.min.css" rel="stylesheet">
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/themes/black-tie/jquery-ui.css" rel="stylesheet">
    <link href="css/jquery.tocify.css" rel="stylesheet">
    <link href="css/prettify.css" rel="stylesheet" type="text/css">
    <link href="css/styles.css" rel="stylesheet" type="text/css">
    <link href="css/rainbow/themes/tomorrow-night.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="css/rainbowlines/theme.css" media="screen" />
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="apple-touch-icon" sizes="57x57" href="/wraith/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/wraith/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/wraith/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/wraith/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/wraith/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/wraith/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/wraith/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/wraith/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/wraith/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/wraith/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/wraith/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/wraith/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/wraith/favicons/favicon-16x16.png">
    <link rel="manifest" href="/wraith/favicons/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/wraith/favicons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <style>
      .wraith_logo {
        width: 100%;
      }
      @media (min-width: 900px) {
        .wraith_logo {
          max-width: 350px;
          float: left;
        }
      }
    </style>

  </head>

  <body>
   <nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="margin-bottom:120px;">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
       <span class="icon-bar"></span>
       <span class="icon-bar"></span>
       <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href=".">Wraith</a>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">
      <li class="active"><a href=".">Main Documentation</a></li>
      <li class><a href="os-install.html">Installation</a></li>
      <li class><a href="configs.html">Example Configs</a></li>
    </ul>
  </div><!-- /.navbar-collapse -->
</nav>

    <div class="container-fluid" style="margin-top:50px;">
      <div class="row">
        <div class="tocify col-sm-3 col-md-3">
          <div id="toc">
          </div><!--/.well -->
        </div><!--/span-->
        <div class="col-sm-9 col-md-9">
          <div class="jumbotron">

            <img class="wraith_logo" src="http://bbc-news.github.io/wraith/img/wraith-logo/wraith-logo-800px.png" />

            <div style="overflow: hidden">
              <h1>Wraith</h1>
              <p>A responsive screenshot comparison tool</p>
              <br>
              <p>The project is hosted on <a class="projectLinks" href="https://github.com/BBC-News/wraith" target="_blank">GitHub</a> and is available for use under the <a class="projectLinks" href="https://github.com/BBC-News/wraith/blob/master/LICENSE" target="_blank">Apache 2.0 open source license</a>.  You can report bugs and discuss features on the <a href="https://github.com/BBC-News/wraith/issues?state=open" target="_blank">GitHub issues page</a>, or send tweets to <a href="https://twitter.com/ResponsiveNews" target="_blank">@ResponsiveNews</a>.
              </p>
              <p><a class="btn btn-primary btn-lg" href="https://github.com/BBC-News/wraith" target="_blank">Fork on GitHub Â»</a></p>
            </div>
          </div>


          <h2>Setup</h2>

          <p class="well">
            <strong>First, you'll need to <a href="http://bbc-news.github.io/wraith/os-install.html">follow the instructions for your operating system to install Wraith's dependencies</a></strong>, as Wraith relies on various programs for it to function properly.
            <br>
            Once you have installed all of Wraith's pre-requisites, you are ready to install the gem:
          </p>

          <pre>
          <code data-language="ruby">
gem install wraith
          </code>
          </pre>

          <p>
            Wraith is now ready to use. Wraith has some built-in JavaScript and configuration file templates for you to get started with right away. The following command will create folders in the directory you are in:
          </p>
          <pre>
          <code data-language="ruby">
wraith setup
          </code>
          </pre>

          <h2>Using Wraith</h2>

          <p>There are two main modes for using Wraith: 'capture' mode and 'history' mode.</p>

          <h3>Capture mode</h3>

          <p>
            <strong>Summary</strong>: given two domains, Wraith will take screenshots of both and compare them.
          </p>

          <p>
            <strong>Use case</strong>: good for comparing test and live versions of the same site.
          </p>

          <p>
            <strong>How do I use it?</strong>
          </p>

          <p>
            Specify TWO domains, and any number of paths and screen widths. Run `wraith capture`.
          </p>

          <pre>
          <code data-language="ruby">
wraith capture configs/capture.yaml
          </code>
          </pre>

          <p>
            If you wish to take screenshots of a component rather than the entire page, <strong>use casperjs and pass a selector</strong> along with your paths. <a href="configs.html">In the 'component' example config</a>, you can see how we specify a component name, domain path and selector we want to capture.
          </p>

          <h3>History mode</h3>

          <p>
            <strong>Summary</strong>: compare the same domain over time.
          </p>

          <p>
            <strong>Use case</strong>: good for checking that your website continues to look the same (especially useful if your site relies on third-party components).
          </p>

          <p>
            <strong>How do I use it?</strong>
          </p>

          <p>
            Specify ONE domain, and any number of paths and screen widths. Make sure you have a `history_dir` property set. Run `wraith history` to generate your base screenshots, and `wraith latest` to generate new screenshots to compare against the old ones. An example of this can be <a href="configs.html">found in the 'history' example config</a>.
          </p>

<pre>
  <code data-language="yaml">
  wraith history
  </code>
</pre>

          <p>
            This will create 2 folders with the labels you have specified in the config file, for example, shots and shots_history. The original shots will be copied into your 'history' folder, then copied back into the shots folder once you have run your latest job. This workflow will essentially mean your history folder is your baseline, being copied back into the shots folder every time you run the following
          </p>

<pre>
  <code data-language="yaml">
  wraith latest
  </code>
</pre>
          <p>
            If you wish to take screenshots of a component rather than the entire page, <strong>use casperjs and pass a selector</strong> along with your paths. <a href="configs.html">In the 'component' example config</a>, you can see how we specify a component name, domain path and selector we want to capture.
          </p>

          <h3>All modes</h3>

          <p>Regardless of which mode you use, certain config options are applicable to both.</p>

          <p>All config options will be placed in a YAML config file. You set the headless browser, diff mode, threshold, fuzz amount and screen widths.</p>
          <b>Headless browser</b> : This is typically PhantomJS or CasperJS - a browser that doesn't have a user interface; it runs in the backround.
          <br>
          <b>Diff Mode</b> : How you would like the gallery to be presented, you can set ordering and for the unchanged images to be removed.
          <br>
          <b>Threshold</b> : This is the minimal level of change you that want to present a failure. The metric is percentage change of the page and set globally for a Wraith run.
          <br>
          <b>Fuzz</b> : Use this option to match colors that are close to the target color in RGB space, this number helps with anti-aliasing.
          <br>
          <b>resize_or_reload</b> : (optional) As of Wraith 3.0.0, you can now tell Wraith to run more efficiently. The old default is 'reload', which reloads the browser for every screen width you want to take a screenshot of. However, you can set it to 'resize' to tell Wraith to resize the browser (rather than reload it) in between taking screenshots - making Wraith run much more quickly.
          <br>
          <b>verbose</b> : (optional: boolean) As of Wraith 3.1.0, you can run Wraith in verbose mode, which lists helpful debug information. Default: false
          <br>
          <b>snap_file</b> : (optional: string) Before Wraith 3.0.0, you were required to specify a path to a snap JavaScript file responsible for taking the command line arguments from Wraith and loading up Phantom/Casper to take screenshots. As of 3.0.0, this functionality has been abstracted away, so <em>you should no longer specify a snap file</em>. However, you are still able to specify a snap file if you wish.
          <br>
          <b>threads</b> : (optional: integer) Number of capture threads to run simultanously
          <br>
          <b>settle</b> : (optional: integer) Number of seconds to wait for the page to settle (when using Chrome as the headless browser)

          <h2>Spider functionality</h2>

          <p class="well">
            You can specify paths in one of two ways. 1) specify the paths manually, or 2) have Wraith crawl your website to determine your paths for you.
          </p>

          <p class="well">
            To have Wraith crawl your site for you, remove the 'paths' property and specify an 'imports' property in your YML file, e.g.
          </p>

<pre>
  <code data-language="yaml">
  imports: "spider_paths.yml"
  </code>
</pre>

          <p class="well">
            Tell Wraith to crawl your domain:
          </p>

<pre>
  <code data-language="yaml">
  wraith spider my_config.yml
  </code>
</pre>

          <p>
            ...this creates a file called spider_paths.yml in the same directory as your my_config.yml. Now you can run Wraith commands as normal, as if you've specified the paths manually:
          </p>

<pre>
  <code data-language="yaml">
  wraith capture my_config.yml
  </code>
</pre>

          <h2>Gallery &amp; Output</h2>
          <p class="well">
          After each screenshot is captured, the compare task will run, this will output a diff.png and a data.txt.  The data.txt for each file will show the number of pixels that have changed.
          <br>
          <br>
          A gallery is available to view each of the images and the respective diff images located in the shots folder once all the images have been compared.
          </p>

          <p class="well">
          As of <a href="https://github.com/BBC-News/wraith/releases/tag/v2.8.0">Wraith version 2.8.0</a>, there are now multiple gallery templates for you to choose from. The basic template is the default one and is simply a list of thumbnails sat side by side. The slideshow template is a new one and gives a more managable way of comparing thumbnails (including seeing everything at once in a lightbox), but is still under development and so is not the default yet.
          <br>
          <br>
          You can choose your template, as well as the size of the generated thumbnails, by specifying the following config:
          </p>

          <pre><code data-language="yaml">
# this property and its sub-properties are all optional
gallery:
  template: 'slideshow_template' # or 'basic_template' (which is the default)
  thumb_width: 200 # default
  thumb_height: 200 # default
          </code></pre>


          <h2>before_capture hooks</h2>

          <p>Using Casper Mode allows you to hook into a 'before_capture' event so that you can run arbitrary JavaScript before taking the screenshot. This allows you to regression test interactive content. (Note: the before_capture hook is currently only supported in Casper Mode).</p>

          <p>There are two options for hooking your JavaScript into the Wraith process, which are denoted by where you specify your 'before_capture' property. This is best illustrated using an example config:</p>

          <pre><code data-language="yaml">
before_capture: "javascript/config-level.js"

# Add as many domains as necessary. Key will act as a label
domains:
  english: "http://www.bbc.co.uk/news"

#Type screen widths below, here are a couple of examples
screen_widths:
  - 320
  - 600
  - 768
  - 1024
  - 1280

#Type page URL paths below, here are a couple of examples
paths:
  clickable_guide:
    path: /entertainment-arts-27221191
    selector: '.idt__news'
  clickable_guide__after_click:
    path: /entertainment-arts-27221191
    selector: '.idt__news'
    before_capture: 'javascript/path-level.js'
          </code></pre>

          <p>The before_capture at the top of the example is called before EVERY path (i.e. before both 'clickable_guide' and 'clickable_guide__after_click'). The before_capture at the bottom of the example is called only before the path which it is associated with (i.e. only before 'clickable_guide__after_click').</p>

          <p>The config-level JS is always executed <em>before</em> the path-level JS. In the example above, that means 'clickable_guide' has config-level.js executed before a screenshot is taken, and 'clickable_guide__after_click' has config-level.js then path-level.js executed before a screenshot is taken.</p>

          <p>All of the before_capture hooks are optional.</p>

          <p>before_capture files should be in module form. Depending on the browser engine used, you may have direct access to the DOM or you may need to access it through the engine in another way. The important thing is to execute the `ready` callback when you're done, otherwise Wraith will hang forever.</p>

          <h4>CasperJS before_capture module</h4>

          <pre><code data-language="javascript">
module.exports = function (casper, ready) {
    // make Wraith wait a bit longer before taking the screenshot
    casper.wait(2000, ready); // you MUST call the ready() callback for Wraith to continue
}
          </code></pre>

          <h4>PhantomJS before_capture module</h4>

          <pre><code data-language="javascript">
module.exports = function (phantom, ready) {
    // make Wraith wait a bit longer before taking the screenshot
    setTimeout(ready, 2000); // you MUST call the ready() callback for Wraith to continue
}
          </code></pre>

          <h2>Command line options</h2>
          <p></p>
          <p class="well note">
Wraith allows for most of the commands to be used individually, allowing you perform tasks as you see fit.  This assumes that your snap.js and config.yaml are in the folders that were created on setup.  There are other commands also available, these all expect a config_name to be passed as an option.
          </p>
          <pre>
		  <code data-language="shell">
  wraith capture [config_name]              # Capture paths against two domains, compare them, generate gallery
  wraith compare_images [config_name]       # compares images to generate diffs
  wraith copy_base_images [config_name]     # copies the required base images over for comparison with latest images
  wraith crop_images [config_name]          # crops images to the same height
  wraith generate_gallery [config_name]     # create page for viewing images
  wraith generate_thumbnails [config_name]  # create thumbnails for gallery
  wraith help [COMMAND]                     # Describe available commands or one specific command
  wraith history [config_name]              # Setup a baseline set of shots
  wraith info                               # See useful system Wraith/ImageMagick/Phantom info
  wraith latest [config_name]               # Capture new shots to compare with baseline
  wraith multi_capture [filelist]           # A Batch of Wraith Jobs
  wraith reset_shots [config_name]          # removes all the files in the shots folder
  wraith save_images [config_name]          # captures screenshots
  wraith setup                              # creates config folder and default config
  wraith setup_folders [config_name]        # create folders for images
  wraith spider [config_name]               # crawl your domain to generate a YML of paths
  wraith validate [config_name]             # checks your configuration and validates that all required properties exist
  wraith version                            # Show the version of Wraith
          </code>
          </pre>





    <h2>More help/tutorials</h2>

    <p class="well">
    If you are new to ruby, rake and PhantomJS, <a href="http://www.youtube.com/watch?v=gE_19L0l2q0" target="_blank">here is a great screencast</a> about how to use Wraith by <a href="https://twitter.com/klamping" target="_blank">Kevin Lamping</a>
    </p>

		<h2>Copyright</h2>
        <p class="well">
            Copyright Â© BBC
        </p>
      </div>
      </div><!--/row-->

    </div><!--/.fluid-container-->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/rainbow/rainbow.min.js"></script>
    <script src="js/rainbow/language/generic.js"></script>
    <script src="js/rainbow/language/html.js"></script>
    <script src="js/rainbow/language/css.js"></script>
    <script src="js/rainbow/language/javascript.js"></script>
    <script src="js/rainbowlines/rainbow.linenumbers.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.tocify.min.js"></script>
    <script src="js/prettify.js"></script>

    <script>
        $(function() {

          $("#toc").tocify({ selectors: "h2, h3, h4", scrollTo: 60, highlightOffset: 60, extendPage: true });

          prettyPrint();

          $(".optionName").popover({ trigger: "hover", container: "body" });

          $("a[href='#']").click(function(event) {

              event.preventDefault();

          });

          Rainbow.color();
        });
    </script>

</div></body></html>
